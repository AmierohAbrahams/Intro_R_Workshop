<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Intro R Workshop: Data Manipulation, Analysis and Graphing</title>
  <meta name="description" content="The basics for a safe voyage through the tidyverse.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Intro R Workshop: Data Manipulation, Analysis and Graphing" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The basics for a safe voyage through the tidyverse." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Intro R Workshop: Data Manipulation, Analysis and Graphing" />
  
  <meta name="twitter:description" content="The basics for a safe voyage through the tidyverse." />
  

<meta name="author" content="Robert W Schlegel &amp; AJ Smit">


<meta name="date" content="2018-01-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="brewing.html">
<link rel="next" href="mapping.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro R Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="prelim.html"><a href="prelim.html"><i class="fa fa-check"></i><b>1</b> Preliminaries</a><ul>
<li class="chapter" data-level="1.1" data-path="prelim.html"><a href="prelim.html#venue-date-and-time"><i class="fa fa-check"></i><b>1.1</b> Venue, date and time</a></li>
<li class="chapter" data-level="1.2" data-path="prelim.html"><a href="prelim.html#course-outline"><i class="fa fa-check"></i><b>1.2</b> Course outline</a><ul>
<li class="chapter" data-level="" data-path="prelim.html"><a href="prelim.html#day-1-in-the-beginning"><i class="fa fa-check"></i>Day 1 – In the Beginning</a></li>
<li class="chapter" data-level="" data-path="prelim.html"><a href="prelim.html#day-2-show-and-tell"><i class="fa fa-check"></i>Day 2 – Show and tell</a></li>
<li class="chapter" data-level="" data-path="prelim.html"><a href="prelim.html#day-3-going-deeper"><i class="fa fa-check"></i>Day 3 – Going deeper</a></li>
<li class="chapter" data-level="" data-path="prelim.html"><a href="prelim.html#day-4-the-enlightened-researcher"><i class="fa fa-check"></i>Day 4 – The Enlightened Researcher</a></li>
<li class="chapter" data-level="" data-path="prelim.html"><a href="prelim.html#day-5-the-world-is-yours"><i class="fa fa-check"></i>Day 5 – The world is yours</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="prelim.html"><a href="prelim.html#about-this-workshop"><i class="fa fa-check"></i><b>1.3</b> About this Workshop</a></li>
<li class="chapter" data-level="1.4" data-path="prelim.html"><a href="prelim.html#why-can-haz-r"><i class="fa fa-check"></i><b>1.4</b> Why can haz R?</a><ul>
<li class="chapter" data-level="1.4.1" data-path="prelim.html"><a href="prelim.html#some-negatives-of-using-r"><i class="fa fa-check"></i><b>1.4.1</b> Some negatives of using R</a></li>
<li class="chapter" data-level="1.4.2" data-path="prelim.html"><a href="prelim.html#the-challenge-learning-to-program-in-r"><i class="fa fa-check"></i><b>1.4.2</b> The challenge: learning to program in R</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="prelim.html"><a href="prelim.html#using-your-own-computer"><i class="fa fa-check"></i><b>1.5</b> Using your own computer?</a><ul>
<li class="chapter" data-level="1.5.1" data-path="prelim.html"><a href="prelim.html#installing-r"><i class="fa fa-check"></i><b>1.5.1</b> Installing R</a></li>
<li class="chapter" data-level="1.5.2" data-path="prelim.html"><a href="prelim.html#installing-rstudio"><i class="fa fa-check"></i><b>1.5.2</b> Installing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="prelim.html"><a href="prelim.html#resources"><i class="fa fa-check"></i><b>1.6</b> Resources</a></li>
<li class="chapter" data-level="1.7" data-path="prelim.html"><a href="prelim.html#style-and-code-conventions"><i class="fa fa-check"></i><b>1.7</b> Style and code conventions</a></li>
<li class="chapter" data-level="1.8" data-path="prelim.html"><a href="prelim.html#about-this-document"><i class="fa fa-check"></i><b>1.8</b> About this document</a></li>
<li class="chapter" data-level="1.9" data-path="prelim.html"><a href="prelim.html#exercise-it-which-shall-not-be-named"><i class="fa fa-check"></i><b>1.9</b> Exercise: It which shall not be named</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio.html"><a href="rstudio.html"><i class="fa fa-check"></i><b>2</b> RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="rstudio.html"><a href="rstudio.html#setting-up-the-workspace"><i class="fa fa-check"></i><b>2.1</b> Setting up the workspace</a><ul>
<li class="chapter" data-level="2.1.1" data-path="rstudio.html"><a href="rstudio.html#general-settings"><i class="fa fa-check"></i><b>2.1.1</b> General settings</a></li>
<li class="chapter" data-level="2.1.2" data-path="rstudio.html"><a href="rstudio.html#customising-appearance"><i class="fa fa-check"></i><b>2.1.2</b> Customising appearance</a></li>
<li class="chapter" data-level="2.1.3" data-path="rstudio.html"><a href="rstudio.html#configuring-panes"><i class="fa fa-check"></i><b>2.1.3</b> Configuring panes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rstudio.html"><a href="rstudio.html#the-rproject"><i class="fa fa-check"></i><b>2.2</b> The RProject</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio.html"><a href="rstudio.html#installing-packages"><i class="fa fa-check"></i><b>2.3</b> Installing packages</a></li>
<li class="chapter" data-level="2.4" data-path="rstudio.html"><a href="rstudio.html#the-panes-of-rstudio"><i class="fa fa-check"></i><b>2.4</b> The panes of RStudio</a><ul>
<li class="chapter" data-level="2.4.1" data-path="rstudio.html"><a href="rstudio.html#source-editor"><i class="fa fa-check"></i><b>2.4.1</b> Source Editor</a></li>
<li class="chapter" data-level="2.4.2" data-path="rstudio.html"><a href="rstudio.html#console"><i class="fa fa-check"></i><b>2.4.2</b> Console</a></li>
<li class="chapter" data-level="2.4.3" data-path="rstudio.html"><a href="rstudio.html#environment-and-history-panes"><i class="fa fa-check"></i><b>2.4.3</b> Environment and History panes</a></li>
<li class="chapter" data-level="2.4.4" data-path="rstudio.html"><a href="rstudio.html#files-plots-packages-help-and-viewer-panes"><i class="fa fa-check"></i><b>2.4.4</b> Files, Plots, Packages, Help and Viewer panes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>3</b> An R workflow</a><ul>
<li class="chapter" data-level="3.1" data-path="workflow.html"><a href="workflow.html#r-scripts"><i class="fa fa-check"></i><b>3.1</b> R Scripts</a></li>
<li class="chapter" data-level="3.2" data-path="workflow.html"><a href="workflow.html#reading-data-into-r"><i class="fa fa-check"></i><b>3.2</b> Reading data into R</a><ul>
<li class="chapter" data-level="3.2.1" data-path="workflow.html"><a href="workflow.html#preparing-data-for-r"><i class="fa fa-check"></i><b>3.2.1</b> Preparing data for R</a></li>
<li class="chapter" data-level="3.2.2" data-path="workflow.html"><a href="workflow.html#converting-data"><i class="fa fa-check"></i><b>3.2.2</b> Converting data</a></li>
<li class="chapter" data-level="3.2.3" data-path="workflow.html"><a href="workflow.html#importing-data"><i class="fa fa-check"></i><b>3.2.3</b> Importing data</a></li>
<li class="chapter" data-level="3.2.4" data-path="workflow.html"><a href="workflow.html#loading-a-file"><i class="fa fa-check"></i><b>3.2.4</b> Loading a file</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="workflow.html"><a href="workflow.html#working-with-data"><i class="fa fa-check"></i><b>3.3</b> Working with data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="workflow.html"><a href="workflow.html#examine-your-data"><i class="fa fa-check"></i><b>3.3.1</b> Examine your data</a></li>
<li class="chapter" data-level="3.3.2" data-path="workflow.html"><a href="workflow.html#tidyverse-sneak-peek"><i class="fa fa-check"></i><b>3.3.2</b> Tidyverse sneak peek</a></li>
<li class="chapter" data-level="3.3.3" data-path="workflow.html"><a href="workflow.html#subsetting"><i class="fa fa-check"></i><b>3.3.3</b> Subsetting</a></li>
<li class="chapter" data-level="3.3.4" data-path="workflow.html"><a href="workflow.html#basic-stats"><i class="fa fa-check"></i><b>3.3.4</b> Basic stats</a></li>
<li class="chapter" data-level="3.3.5" data-path="workflow.html"><a href="workflow.html#summary-of-all-variables-in-a-dataframe"><i class="fa fa-check"></i><b>3.3.5</b> Summary of all variables in a dataframe</a></li>
<li class="chapter" data-level="3.3.6" data-path="workflow.html"><a href="workflow.html#summary-statistics-by-variable"><i class="fa fa-check"></i><b>3.3.6</b> Summary statistics by variable</a></li>
<li class="chapter" data-level="3.3.7" data-path="workflow.html"><a href="workflow.html#more-complex-calculations"><i class="fa fa-check"></i><b>3.3.7</b> More complex calculations</a></li>
<li class="chapter" data-level="3.3.8" data-path="workflow.html"><a href="workflow.html#factor-summaries"><i class="fa fa-check"></i><b>3.3.8</b> Factor summaries</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="workflow.html"><a href="workflow.html#saving-data"><i class="fa fa-check"></i><b>3.4</b> Saving data</a></li>
<li class="chapter" data-level="3.5" data-path="workflow.html"><a href="workflow.html#visualisations"><i class="fa fa-check"></i><b>3.5</b> Visualisations</a></li>
<li class="chapter" data-level="3.6" data-path="workflow.html"><a href="workflow.html#clearing-the-memory"><i class="fa fa-check"></i><b>3.6</b> Clearing the memory</a></li>
<li class="chapter" data-level="3.7" data-path="workflow.html"><a href="workflow.html#working-directories"><i class="fa fa-check"></i><b>3.7</b> Working directories</a></li>
<li class="chapter" data-level="3.8" data-path="workflow.html"><a href="workflow.html#help"><i class="fa fa-check"></i><b>3.8</b> Help</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>4</b> Graphics with <strong><code>ggplot2</code></strong></a><ul>
<li class="chapter" data-level="4.1" data-path="graphics.html"><a href="graphics.html#example-figures"><i class="fa fa-check"></i><b>4.1</b> Example figures</a></li>
<li class="chapter" data-level="4.2" data-path="graphics.html"><a href="graphics.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>4.2</b> Basics of <strong><code>ggplot2</code></strong></a></li>
<li class="chapter" data-level="4.3" data-path="graphics.html"><a href="graphics.html#changing-labels"><i class="fa fa-check"></i><b>4.3</b> Changing labels</a></li>
<li class="chapter" data-level="4.4" data-path="graphics.html"><a href="graphics.html#to-aes-or-not-to-aes-that-is-the-question"><i class="fa fa-check"></i><b>4.4</b> To <code>aes()</code> or not to <code>aes()</code>, that is the question</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="faceting.html"><a href="faceting.html"><i class="fa fa-check"></i><b>5</b> Faceting Figures</a><ul>
<li class="chapter" data-level="5.1" data-path="faceting.html"><a href="faceting.html#faceting-one-figure"><i class="fa fa-check"></i><b>5.1</b> Faceting one figure</a></li>
<li class="chapter" data-level="5.2" data-path="faceting.html"><a href="faceting.html#new-figure-types"><i class="fa fa-check"></i><b>5.2</b> New figure types</a><ul>
<li class="chapter" data-level="5.2.1" data-path="faceting.html"><a href="faceting.html#linear-model"><i class="fa fa-check"></i><b>5.2.1</b> Linear model</a></li>
<li class="chapter" data-level="5.2.2" data-path="faceting.html"><a href="faceting.html#histogram"><i class="fa fa-check"></i><b>5.2.2</b> Histogram</a></li>
<li class="chapter" data-level="5.2.3" data-path="faceting.html"><a href="faceting.html#density-plot"><i class="fa fa-check"></i><b>5.2.3</b> Density plot</a></li>
<li class="chapter" data-level="5.2.4" data-path="faceting.html"><a href="faceting.html#boxplot"><i class="fa fa-check"></i><b>5.2.4</b> Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="faceting.html"><a href="faceting.html#gridding-figures"><i class="fa fa-check"></i><b>5.3</b> Gridding figures</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="brewing.html"><a href="brewing.html"><i class="fa fa-check"></i><b>6</b> Brewing colours in <strong><code>ggplot2</code></strong></a><ul>
<li class="chapter" data-level="6.1" data-path="brewing.html"><a href="brewing.html#r-data"><i class="fa fa-check"></i><b>6.1</b> R Data</a></li>
<li class="chapter" data-level="6.2" data-path="brewing.html"><a href="brewing.html#rcolorbrewer"><i class="fa fa-check"></i><b>6.2</b> <strong><code>RColorBrewer</code></strong></a></li>
<li class="chapter" data-level="6.3" data-path="brewing.html"><a href="brewing.html#make-your-own-palettes"><i class="fa fa-check"></i><b>6.3</b> Make your own palettes</a></li>
<li class="chapter" data-level="6.4" data-path="brewing.html"><a href="brewing.html#use-your-own-palettes"><i class="fa fa-check"></i><b>6.4</b> Use your own palettes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="plot-stats.html"><a href="plot-stats.html"><i class="fa fa-check"></i><b>7</b> Plotting statistics</a><ul>
<li class="chapter" data-level="7.1" data-path="plot-stats.html"><a href="plot-stats.html#new-functions"><i class="fa fa-check"></i><b>7.1</b> New functions</a></li>
<li class="chapter" data-level="7.2" data-path="plot-stats.html"><a href="plot-stats.html#further-applications"><i class="fa fa-check"></i><b>7.2</b> Further applications</a></li>
<li class="chapter" data-level="7.3" data-path="plot-stats.html"><a href="plot-stats.html#diy-figures"><i class="fa fa-check"></i><b>7.3</b> DIY figures</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mapping.html"><a href="mapping.html"><i class="fa fa-check"></i><b>8</b> Mapping with <strong><code>ggplot2</code></strong></a><ul>
<li class="chapter" data-level="8.1" data-path="mapping.html"><a href="mapping.html#a-new-concept"><i class="fa fa-check"></i><b>8.1</b> A new concept?</a></li>
<li class="chapter" data-level="8.2" data-path="mapping.html"><a href="mapping.html#built-in-maps"><i class="fa fa-check"></i><b>8.2</b> Built in maps</a></li>
<li class="chapter" data-level="8.3" data-path="mapping.html"><a href="mapping.html#creating-a-map"><i class="fa fa-check"></i><b>8.3</b> Creating a map</a></li>
<li class="chapter" data-level="8.4" data-path="mapping.html"><a href="mapping.html#a-ribbon-for-your-troubles"><i class="fa fa-check"></i><b>8.4</b> A ribbon for your troubles</a></li>
<li class="chapter" data-level="8.5" data-path="mapping.html"><a href="mapping.html#combining-figures"><i class="fa fa-check"></i><b>8.5</b> Combining figures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mapping-google.html"><a href="mapping-google.html"><i class="fa fa-check"></i><b>9</b> Mapping with Google</a><ul>
<li class="chapter" data-level="9.1" data-path="mapping-google.html"><a href="mapping-google.html#ggmap"><i class="fa fa-check"></i><b>9.1</b> <strong><code>ggmap</code></strong></a></li>
<li class="chapter" data-level="9.2" data-path="mapping-google.html"><a href="mapping-google.html#mapping-cape-point"><i class="fa fa-check"></i><b>9.2</b> Mapping Cape Point</a></li>
<li class="chapter" data-level="9.3" data-path="mapping-google.html"><a href="mapping-google.html#site-labels"><i class="fa fa-check"></i><b>9.3</b> Site labels</a></li>
<li class="chapter" data-level="9.4" data-path="mapping-google.html"><a href="mapping-google.html#specific-labels"><i class="fa fa-check"></i><b>9.4</b> Specific labels</a></li>
<li class="chapter" data-level="9.5" data-path="mapping-google.html"><a href="mapping-google.html#scale-bars"><i class="fa fa-check"></i><b>9.5</b> Scale bars</a></li>
<li class="chapter" data-level="9.6" data-path="mapping-google.html"><a href="mapping-google.html#insetting"><i class="fa fa-check"></i><b>9.6</b> Insetting</a></li>
<li class="chapter" data-level="9.7" data-path="mapping-google.html"><a href="mapping-google.html#rounding-it-out"><i class="fa fa-check"></i><b>9.7</b> Rounding it out</a></li>
<li class="chapter" data-level="9.8" data-path="mapping-google.html"><a href="mapping-google.html#diy-maps"><i class="fa fa-check"></i><b>9.8</b> DIY maps</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>10</b> Tidy data</a><ul>
<li class="chapter" data-level="10.1" data-path="tidy.html"><a href="tidy.html#gathering-and-spreading"><i class="fa fa-check"></i><b>10.1</b> Gathering and spreading</a><ul>
<li class="chapter" data-level="10.1.1" data-path="tidy.html"><a href="tidy.html#gathering"><i class="fa fa-check"></i><b>10.1.1</b> Gathering</a></li>
<li class="chapter" data-level="10.1.2" data-path="tidy.html"><a href="tidy.html#spreading"><i class="fa fa-check"></i><b>10.1.2</b> Spreading</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tidy.html"><a href="tidy.html#separating-and-uniting"><i class="fa fa-check"></i><b>10.2</b> Separating and uniting</a><ul>
<li class="chapter" data-level="10.2.1" data-path="tidy.html"><a href="tidy.html#separate"><i class="fa fa-check"></i><b>10.2.1</b> Separate</a></li>
<li class="chapter" data-level="10.2.2" data-path="tidy.html"><a href="tidy.html#unite"><i class="fa fa-check"></i><b>10.2.2</b> Unite</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tidy.html"><a href="tidy.html#joining"><i class="fa fa-check"></i><b>10.3</b> Joining</a></li>
<li class="chapter" data-level="10.4" data-path="tidy.html"><a href="tidy.html#but-why-though"><i class="fa fa-check"></i><b>10.4</b> But why though?</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="tidier.html"><a href="tidier.html"><i class="fa fa-check"></i><b>11</b> Tidier data</a><ul>
<li class="chapter" data-level="11.1" data-path="tidier.html"><a href="tidier.html#comparison-operators"><i class="fa fa-check"></i><b>11.1</b> Comparison operators</a></li>
<li class="chapter" data-level="11.2" data-path="tidier.html"><a href="tidier.html#logical-operators"><i class="fa fa-check"></i><b>11.2</b> Logical operators</a></li>
<li class="chapter" data-level="11.3" data-path="tidier.html"><a href="tidier.html#arrange-observations-rows-with-arrange"><i class="fa fa-check"></i><b>11.3</b> Arrange observations (rows) with <code>arrange()</code></a></li>
<li class="chapter" data-level="11.4" data-path="tidier.html"><a href="tidier.html#filter-observations-rows-with-filter"><i class="fa fa-check"></i><b>11.4</b> Filter observations (rows) with <code>filter()</code></a></li>
<li class="chapter" data-level="11.5" data-path="tidier.html"><a href="tidier.html#select-variables-columns-withselect"><i class="fa fa-check"></i><b>11.5</b> Select variables (columns) with<code>select()</code></a></li>
<li class="chapter" data-level="11.6" data-path="tidier.html"><a href="tidier.html#create-new-variables-columns-with-mutate"><i class="fa fa-check"></i><b>11.6</b> Create new variables (columns) with <code>mutate()</code></a></li>
<li class="chapter" data-level="11.7" data-path="tidier.html"><a href="tidier.html#summarise-variables-columns-with-summarise"><i class="fa fa-check"></i><b>11.7</b> Summarise variables (columns) with <code>summarise()</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="tidiest.html"><a href="tidiest.html"><i class="fa fa-check"></i><b>12</b> Tidiest data</a><ul>
<li class="chapter" data-level="12.1" data-path="tidiest.html"><a href="tidiest.html#group-observations-rows-by-variables-columns-with-group_by"><i class="fa fa-check"></i><b>12.1</b> Group observations (rows) by variables (columns) with <code>group_by()</code></a><ul>
<li class="chapter" data-level="12.1.1" data-path="tidiest.html"><a href="tidiest.html#grouping-by-multiple-variables"><i class="fa fa-check"></i><b>12.1.1</b> Grouping by multiple variables</a></li>
<li class="chapter" data-level="12.1.2" data-path="tidiest.html"><a href="tidiest.html#ungrouping"><i class="fa fa-check"></i><b>12.1.2</b> Ungrouping</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="tidiest.html"><a href="tidiest.html#chain-functions-with-the-pipe"><i class="fa fa-check"></i><b>12.2</b> Chain functions with the pipe (<code>%&gt;%</code>)</a></li>
<li class="chapter" data-level="12.3" data-path="tidiest.html"><a href="tidiest.html#group-all-the-functions"><i class="fa fa-check"></i><b>12.3</b> Group all the functions!</a></li>
<li class="chapter" data-level="12.4" data-path="tidiest.html"><a href="tidiest.html#going-deeper"><i class="fa fa-check"></i><b>12.4</b> Going deeper</a></li>
<li class="chapter" data-level="12.5" data-path="tidiest.html"><a href="tidiest.html#pipe-into-ggplot2"><i class="fa fa-check"></i><b>12.5</b> Pipe into <strong><code>ggplot2</code></strong></a></li>
<li class="chapter" data-level="12.6" data-path="tidiest.html"><a href="tidiest.html#additional-useful-functions"><i class="fa fa-check"></i><b>12.6</b> Additional useful functions</a><ul>
<li class="chapter" data-level="12.6.1" data-path="tidiest.html"><a href="tidiest.html#rename-variables-columns-with-rename"><i class="fa fa-check"></i><b>12.6.1</b> Rename variables (columns) with <code>rename()</code></a></li>
<li class="chapter" data-level="12.6.2" data-path="tidiest.html"><a href="tidiest.html#create-a-new-dataframe-for-a-newly-created-variable-column-with-transmute"><i class="fa fa-check"></i><b>12.6.2</b> Create a new dataframe for a newly created variable (column) with <code>transmute()</code></a></li>
<li class="chapter" data-level="12.6.3" data-path="tidiest.html"><a href="tidiest.html#count-observations-rows-with-n"><i class="fa fa-check"></i><b>12.6.3</b> Count observations (rows) with <code>n()</code></a></li>
<li class="chapter" data-level="12.6.4" data-path="tidiest.html"><a href="tidiest.html#select-observations-rows-by-number-with-slice"><i class="fa fa-check"></i><b>12.6.4</b> Select observations (rows) by number with <code>slice()</code></a></li>
<li class="chapter" data-level="12.6.5" data-path="tidiest.html"><a href="tidiest.html#summary-functions"><i class="fa fa-check"></i><b>12.6.5</b> Summary functions</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="tidiest.html"><a href="tidiest.html#the-new-age-redux"><i class="fa fa-check"></i><b>12.7</b> The new age <em>redux</em></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="recap.html"><a href="recap.html"><i class="fa fa-check"></i><b>13</b> Recap</a><ul>
<li class="chapter" data-level="13.1" data-path="recap.html"><a href="recap.html#the-future"><i class="fa fa-check"></i><b>13.1</b> The future</a></li>
<li class="chapter" data-level="13.2" data-path="recap.html"><a href="recap.html#today"><i class="fa fa-check"></i><b>13.2</b> Today</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro R Workshop: Data Manipulation, Analysis and Graphing</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plot_stats" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Plotting statistics</h1>
<blockquote>
<p>“How beautiful the world was when one looked at it without searching, just looked, simply and innocently.”</p>
<p>— Hermann Hesse, Siddartha</p>
</blockquote>
<blockquote>
<p>“Facts are stubborn things, but statistics are pliable.”</p>
<p>— Mark Twain</p>
</blockquote>
<p>In this chapter we are going to learn some streamlined techniques for plotting our statistics within <strong><code>ggplot2</code></strong> figures. To do so we will again be making use of <strong><code>ggpubr</code></strong>. We will also load some of the SACTN temperature data to use for our examples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Libraries</span>
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(ggpubr)

<span class="co"># Data</span>
SACTN &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/SACTN_data.csv&quot;</span>)</code></pre></div>
<div id="new-functions" class="section level2">
<h2><span class="header-section-number">7.1</span> New functions</h2>
<p>We will be learning to use two new functions today. The first will be <code>compare_means()</code>, which is a function that compares means of two (t-test) or more (ANOVA) groups of values all in one convenient place. This function is used for statistical tests, but not for creating figures. The second function we will learn to use, <code>stat_compare_means()</code>, does much the same thing as <code>compare_means()</code> but is designed to be integrated directly into <strong><code>ggplot2</code></strong> code.</p>
<p>The <code>compare_means()</code> function uses the formula input we have already seen for other functions throughout R, such as the <code>lm()</code>. The line of code below shows how we would go about doing an ANOVA that investigates the differences between temperatures (°C) at different sites.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">compare_means</span>(temp<span class="op">~</span>site, <span class="dt">data =</span> SACTN, <span class="dt">method =</span> <span class="st">&quot;anova&quot;</span>)</code></pre></div>
<pre><code>R&gt; # A tibble: 1 x 6
R&gt;   .y.                          p                   p.adj p.fo… p.si… meth…
R&gt;   &lt;chr&gt;                    &lt;dbl&gt;                   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
R&gt; 1 temp                 2.55e⁻²⁰⁷               2.55e⁻²⁰⁷ &lt;2e-… ****  Anova</code></pre>
<p>How snazzy is that?! And this works just as well for two mean (t-test) comparisons. It also has built into it the necessary tests for non-parametric comparisons as well as paired tests but we won’t show that explicitly here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">compare_means</span>(temp<span class="op">~</span>site, <span class="dt">data =</span> <span class="kw">filter</span>(SACTN, site <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Port Nolloth&quot;</span>, <span class="st">&quot;Muizenberg&quot;</span>)), <span class="dt">method =</span> <span class="st">&quot;t.test&quot;</span>)</code></pre></div>
<pre><code>R&gt; # A tibble: 1 x 8
R&gt;   .y.   group1       group2                p       p.adj p.fo… p.si… meth…
R&gt;   &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
R&gt; 1 temp  Port Nolloth Muizenberg    6.39e⁻¹¹⁸   6.39e⁻¹¹⁸ &lt;2e-… ****  T-te…</code></pre>
<p>This is great, but it is not new functionality, just drastically improved functionality. The second function introduced in this package is what is really going to make our lives easier. The first two lines in the following code chunk should look very familiar. We are creating a basic boxplot but with a twist. The third line of code, <code>stat_compare_means()</code>, will run an ANOVA for us “<em>in situ</em>” and automatically add the <em>p</em>-value to our boxplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> SACTN, <span class="kw">aes</span>(<span class="dt">x =</span> site, <span class="dt">y =</span> temp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> site), <span class="dt">show.legend =</span> F) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">method =</span> <span class="st">&quot;anova&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:plot-stats-1"></span>
<img src="07-plot_stats_files/figure-html/plot-stats-1-1.png" alt="Boxplot showing *p*-value result for an ANOVA comparing temperatures (°C) between sites." width="672" />
<p class="caption">
Figure 7.1: Boxplot showing <em>p</em>-value result for an ANOVA comparing temperatures (°C) between sites.
</p>
</div>
<p>I find this to be a very impressive bit of code. The author of this function has devised a way to convince the rather unique <strong><code>ggplot2</code></strong> back end to do our dirty work for us and is able to use the x and y axes to calculate statistical analyses. And if that isn’t enough, it then goes and puts it on our figure for us! Because this is all still happening within the confines of <strong><code>ggplot2</code></strong> code, everything can be changed as we desire. The following is just an example, not necessarily the best way to visualise this information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> SACTN, <span class="kw">aes</span>(<span class="dt">x =</span> site, <span class="dt">y =</span> temp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill  =</span> site), <span class="dt">show.legend =</span> F) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">method =</span> <span class="st">&quot;anova&quot;</span>, <span class="co"># Choose stat, same as above</span>
                     <span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;p &quot;</span>, ..p.format..)), <span class="co"># Remove &quot;Anova&quot; text</span>
                     <span class="dt">label.x =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Set label position</span>
<span class="st">  </span><span class="co"># The following two lines simply make the figure prettier</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Site&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Temperature (°C)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Clean up labels</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="co"># Choose different theme</span></code></pre></div>
<div class="figure"><span id="fig:plot-stats-2"></span>
<img src="07-plot_stats_files/figure-html/plot-stats-2-1.png" alt="The same as the preceeding figure, but with minor touch ups." width="672" />
<p class="caption">
Figure 7.2: The same as the preceeding figure, but with minor touch ups.
</p>
</div>
</div>
<div id="further-applications" class="section level2">
<h2><span class="header-section-number">7.2</span> Further applications</h2>
<p>As mentioned above, these functions may be used with paired tests, non-parametric tests, and multiple mean tests. These outputs have mates in the <strong><code>ggplot2</code></strong> sphere and so may be visualised with relative ease. Below we see an example of how to do this with a multiple mean (ANOVA) test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First get a list of the different sites to be compared</span>
SACTN_levels &lt;-<span class="st"> </span><span class="kw">levels</span>(<span class="kw">as.factor</span>(SACTN<span class="op">$</span>site))

<span class="co"># Then manually construct a list of desired pairwise comparisons</span>
my_comparisons &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(SACTN_levels[<span class="dv">1</span>], SACTN_levels[<span class="dv">2</span>]), 
                       <span class="kw">c</span>(SACTN_levels[<span class="dv">2</span>], SACTN_levels[<span class="dv">3</span>]),
                       <span class="kw">c</span>(SACTN_levels[<span class="dv">1</span>], SACTN_levels[<span class="dv">3</span>]))

<span class="co"># And then we wack it all together</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> SACTN, <span class="kw">aes</span>(<span class="dt">x =</span> site, <span class="dt">y =</span> temp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill  =</span> site), <span class="dt">show.legend =</span> F) <span class="op">+</span>
<span class="st">  </span><span class="co"># Calculate ANOVA for all sites</span>
<span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">method =</span> <span class="st">&quot;anova&quot;</span>, 
                     <span class="dt">label.x =</span> <span class="fl">1.9</span>, <span class="dt">label.y =</span> <span class="dv">33</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># Add pairwise comparisons p-value</span>
<span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">comparisons =</span> my_comparisons,
                     <span class="dt">label.y =</span> <span class="kw">c</span>(<span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">30</span>)) <span class="op">+</span>
<span class="st">  </span><span class="co"># Perform t-tests between each group and the overall mean</span>
<span class="st">    </span><span class="co"># This shows up as the asterisks above each box</span>
<span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">label =</span> <span class="st">&quot;p.signif&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;t.test&quot;</span>,
                     <span class="dt">ref.group =</span> <span class="st">&quot;.all.&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># Add horizontal line at base mean</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(SACTN<span class="op">$</span>temp, <span class="dt">na.rm =</span> T), <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Pretty labels and theme</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Temp. (°C)&quot;</span>, <span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<div class="figure"><span id="fig:plot-stats-3"></span>
<img src="07-plot_stats_files/figure-html/plot-stats-3-1.png" alt="Boxplots showing a wealth of statistical information. Refer to the following text for a full description." width="672" />
<p class="caption">
Figure 7.3: Boxplots showing a wealth of statistical information. Refer to the following text for a full description.
</p>
</div>
<p>The above figure, boxplots showing the distribution of temperatures (°C) for each site, contains a lot of densely packed information that we will now work through together. Firstly, the horizontal dashed line nearer the bottom shows what the overall mean temperature (°C) across all three time series is. Next, the little asterisks above each box show the significance value of the difference of this group (site) from the mean temperature (dashed line). Four asterisks means <em>p</em>&lt;0.001. The pair wise comparisons of each site are shown with black brackets, the text on top of which show the <em>p</em>-values of those comparisons. lastly, the text at the very top of the figure shows the overall <em>p</em>-value for the ANOVA that compared all means against one another. Generally one would not want to show all of this information in one figure. This just serves as an example of how straightforward it is to do so.</p>
<p>For a more detailed explanation for how to perform more advanced comparisons of multiple groups (especially paired comparisons), and how to plot all of those results in a very cunning way, one may follow this link: <a href="https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/" class="uri">https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/</a>.</p>
</div>
<div id="diy-figures" class="section level2">
<h2><span class="header-section-number">7.3</span> DIY figures</h2>
<p>Today we learned the basics of <strong><code>ggplot2</code></strong>, how to facet, how to brew colours, and how to plot stats. Sjog, that’s a lot of stuff to remember! Which is why we will now spend the rest of Day 2 putting our new found skills to use. Please group up as you see fit to produce your very own <strong><code>ggplot2</code></strong> figures. We’ve not yet learned how to manipulate/tidy up our data so it may be challenging to grab any ol’ dataset and make a plan with it. To that end we recommend using the built in datasets in the <strong><code>datasets</code></strong> package. You are of course free to use whatever dataset you would like, including your own. The goal by the end of this session is to have created at least two figures (first prize for four figures) and join them together via faceting. We will be walking the room to help with any issues that may arise.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="brewing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mapping.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
